<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gemini API í…ŒìŠ¤íŠ¸</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: white;
        }
        .container {
            background: rgba(255, 255, 255, 0.1);
            padding: 30px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        h1 {
            text-align: center;
            margin-bottom: 30px;
            color: #fff;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .test-section h3 {
            margin-top: 0;
            color: #fff;
        }
        button {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }
        button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }
        .result {
            margin-top: 15px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            border-left: 4px solid #00ff88;
            white-space: pre-wrap;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            max-height: 300px;
            overflow-y: auto;
        }
        .error {
            border-left-color: #ff4757;
            background: rgba(255, 71, 87, 0.1);
        }
        .success {
            border-left-color: #00ff88;
            background: rgba(0, 255, 136, 0.1);
        }
        .loading {
            border-left-color: #ffa502;
            background: rgba(255, 165, 2, 0.1);
        }
        .api-key-input {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            font-size: 16px;
            margin-bottom: 20px;
        }
        .status {
            text-align: center;
            padding: 10px;
            border-radius: 8px;
            margin: 10px 0;
            font-weight: bold;
        }
        .status.success {
            background: rgba(0, 255, 136, 0.2);
            color: #00ff88;
        }
        .status.error {
            background: rgba(255, 71, 87, 0.2);
            color: #ff4757;
        }
        .status.warning {
            background: rgba(255, 165, 2, 0.2);
            color: #ffa502;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¤– Gemini API í…ŒìŠ¤íŠ¸</h1>
        
        <!-- API í‚¤ ì…ë ¥ -->
        <div class="test-section">
            <h3>ğŸ”‘ API í‚¤ ì„¤ì •</h3>
            <input type="text" id="apiKeyInput" class="api-key-input" 
                   placeholder="Gemini API í‚¤ë¥¼ ì…ë ¥í•˜ì„¸ìš”" 
                   value="AIzaSyDFKAfEDMhqiGcJuOz5jjuEAUGg3Yvn46k">
            <button onclick="validateAPIKey()">API í‚¤ ê²€ì¦</button>
            <div id="apiKeyStatus"></div>
        </div>

        <!-- ê¸°ë³¸ ì—°ê²° í…ŒìŠ¤íŠ¸ -->
        <div class="test-section">
            <h3>ğŸ§ª ê¸°ë³¸ ì—°ê²° í…ŒìŠ¤íŠ¸</h3>
            <button onclick="testBasicConnection()">ê¸°ë³¸ ì—°ê²° í…ŒìŠ¤íŠ¸</button>
            <div id="basicTestResult" class="result"></div>
        </div>

        <!-- ê¸ˆìœµ ìƒë‹´ í…ŒìŠ¤íŠ¸ -->
        <div class="test-section">
            <h3>ğŸ’° ê¸ˆìœµ ìƒë‹´ í…ŒìŠ¤íŠ¸</h3>
            <button onclick="testFinancialAdvice()">ê¸ˆìœµ ìƒë‹´ ìš”ì²­</button>
            <div id="financialTestResult" class="result"></div>
        </div>

        <!-- ì˜ˆì‚° ë¶„ì„ í…ŒìŠ¤íŠ¸ -->
        <div class="test-section">
            <h3>ğŸ“Š ì˜ˆì‚° ë¶„ì„ í…ŒìŠ¤íŠ¸</h3>
            <button onclick="testBudgetAnalysis()">ì˜ˆì‚° ë¶„ì„ ìš”ì²­</button>
            <div id="budgetTestResult" class="result"></div>
        </div>

        <!-- íˆ¬ì ìƒë‹´ í…ŒìŠ¤íŠ¸ -->
        <div class="test-section">
            <h3>ğŸ“ˆ íˆ¬ì ìƒë‹´ í…ŒìŠ¤íŠ¸</h3>
            <button onclick="testInvestmentAdvice()">íˆ¬ì ìƒë‹´ ìš”ì²­</button>
            <div id="investmentTestResult" class="result"></div>
        </div>

        <!-- ì „ì²´ í…ŒìŠ¤íŠ¸ -->
        <div class="test-section">
            <h3>ğŸš€ ì „ì²´ í…ŒìŠ¤íŠ¸</h3>
            <button onclick="runAllTests()">ëª¨ë“  í…ŒìŠ¤íŠ¸ ì‹¤í–‰</button>
            <div id="allTestsResult" class="result"></div>
        </div>
    </div>

    <script>
        // Gemini API ì„¤ì •
        const GEMINI_API_KEY = 'AIzaSyDFKAfEDMhqiGcJuOz5jjuEAUGg3Yvn46k';
        // ì—¬ëŸ¬ ê°€ëŠ¥í•œ ì—”ë“œí¬ì¸íŠ¸ ì‹œë„ (Google AI Studio ìµœì‹  ì •ë³´ ë°˜ì˜)
        const BASE_URLS = [
            'https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent',
            'https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash-exp:generateContent',
            'https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent',
            'https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-pro:generateContent',
            'https://generativelanguage.googleapis.com/v1/models/gemini-1.5-flash:generateContent',
            'https://generativelanguage.googleapis.com/v1/models/gemini-1.5-pro:generateContent',
            'https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent'
        ];
        let currentUrlIndex = 0;
        let BASE_URL = BASE_URLS[currentUrlIndex];

        // API í‚¤ ê²€ì¦
        function validateAPIKey() {
            const apiKey = document.getElementById('apiKeyInput').value;
            const statusDiv = document.getElementById('apiKeyStatus');
            
            if (!apiKey) {
                showStatus(statusDiv, 'API í‚¤ê°€ ì…ë ¥ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.', 'error');
                return false;
            }
            
            if (apiKey.length < 20) {
                showStatus(statusDiv, 'API í‚¤ê°€ ë„ˆë¬´ ì§§ìŠµë‹ˆë‹¤.', 'error');
                return false;
            }
            
            if (apiKey.startsWith('AIza')) {
                showStatus(statusDiv, 'âœ… API í‚¤ í˜•ì‹ì´ ì˜¬ë°”ë¦…ë‹ˆë‹¤.', 'success');
                return true;
            } else {
                showStatus(statusDiv, 'âš ï¸ API í‚¤ í˜•ì‹ì´ ì˜ˆìƒê³¼ ë‹¤ë¦…ë‹ˆë‹¤.', 'warning');
                return false;
            }
        }

        // ìƒíƒœ í‘œì‹œ
        function showStatus(element, message, type) {
            element.innerHTML = `<div class="status ${type}">${message}</div>`;
        }

        // ê²°ê³¼ í‘œì‹œ
        function showResult(elementId, content, type = 'success') {
            const element = document.getElementById(elementId);
            element.textContent = content;
            element.className = `result ${type}`;
        }

        // ë¡œë”© í‘œì‹œ
        function showLoading(elementId) {
            const element = document.getElementById(elementId);
            element.textContent = 'â³ ìš”ì²­ ì²˜ë¦¬ ì¤‘...';
            element.className = 'result loading';
        }

        // Gemini API í˜¸ì¶œ
        async function callGeminiAPI(prompt, maxTokens = 1024) {
            const apiKey = document.getElementById('apiKeyInput').value;
            
            if (!validateAPIKey()) {
                throw new Error('ìœ íš¨í•˜ì§€ ì•Šì€ API í‚¤ì…ë‹ˆë‹¤.');
            }

            const requestBody = {
                contents: [{
                    parts: [{
                        text: prompt
                    }]
                }],
                generationConfig: {
                    temperature: 0.7,
                    topK: 40,
                    topP: 0.95,
                    maxOutputTokens: maxTokens,
                },
                safetySettings: [
                    {
                        category: "HARM_CATEGORY_HARASSMENT",
                        threshold: "BLOCK_MEDIUM_AND_ABOVE"
                    },
                    {
                        category: "HARM_CATEGORY_HATE_SPEECH",
                        threshold: "BLOCK_MEDIUM_AND_ABOVE"
                    },
                    {
                        category: "HARM_CATEGORY_SEXUALLY_EXPLICIT",
                        threshold: "BLOCK_MEDIUM_AND_ABOVE"
                    },
                    {
                        category: "HARM_CATEGORY_DANGEROUS_CONTENT",
                        threshold: "BLOCK_MEDIUM_AND_ABOVE"
                    }
                ]
            };

            // ì—¬ëŸ¬ ì—”ë“œí¬ì¸íŠ¸ ì‹œë„
            for (let i = 0; i < BASE_URLS.length; i++) {
                try {
                    const currentUrl = BASE_URLS[i];
                    console.log(`ğŸ”„ ì—”ë“œí¬ì¸íŠ¸ ì‹œë„ ${i + 1}: ${currentUrl}`);
                    
                    const response = await fetch(`${currentUrl}?key=${apiKey}`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(requestBody),
                    });

                    if (response.ok) {
                        console.log(`âœ… ì„±ê³µí•œ ì—”ë“œí¬ì¸íŠ¸: ${currentUrl}`);
                        const data = await response.json();
                        
                        if (data.candidates && data.candidates[0] && data.candidates[0].content) {
                            return data.candidates[0].content.parts[0].text;
                        } else {
                            throw new Error('ì‘ë‹µì—ì„œ ë‹µë³€ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                        }
                    } else if (response.status === 404) {
                        console.log(`âŒ 404 ì˜¤ë¥˜: ${currentUrl}`);
                        continue; // ë‹¤ìŒ ì—”ë“œí¬ì¸íŠ¸ ì‹œë„
                    } else {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                } catch (error) {
                    console.log(`âŒ ì—”ë“œí¬ì¸íŠ¸ ${i + 1} ì‹¤íŒ¨: ${error.message}`);
                    if (i === BASE_URLS.length - 1) {
                        // ëª¨ë“  ì—”ë“œí¬ì¸íŠ¸ ì‹¤íŒ¨
                        throw new Error(`ëª¨ë“  Gemini API ì—”ë“œí¬ì¸íŠ¸ ì‹œë„ ì‹¤íŒ¨. ë§ˆì§€ë§‰ ì˜¤ë¥˜: ${error.message}`);
                    }
                }
            }
        }

        // ê¸°ë³¸ ì—°ê²° í…ŒìŠ¤íŠ¸
        async function testBasicConnection() {
            showLoading('basicTestResult');
            
            try {
                const prompt = "ì•ˆë…•í•˜ì„¸ìš”! ê°„ë‹¨íˆ 'Hello World'ë¼ê³  í•œêµ­ì–´ë¡œ ë‹µë³€í•´ì£¼ì„¸ìš”.";
                const result = await callGeminiAPI(prompt, 100);
                
                showResult('basicTestResult', 
                    `âœ… ê¸°ë³¸ ì—°ê²° í…ŒìŠ¤íŠ¸ ì„±ê³µ!\n\nì§ˆë¬¸: ${prompt}\n\në‹µë³€: ${result}`, 
                    'success'
                );
            } catch (error) {
                showResult('basicTestResult', 
                    `âŒ ê¸°ë³¸ ì—°ê²° í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨:\n\nì˜¤ë¥˜: ${error.message}`, 
                    'error'
                );
            }
        }

        // ê¸ˆìœµ ìƒë‹´ í…ŒìŠ¤íŠ¸
        async function testFinancialAdvice() {
            showLoading('financialTestResult');
            
            try {
                const prompt = `ë‹¹ì‹ ì€ í•œêµ­ì˜ ì „ë¬¸ ê¸ˆìœµ ìƒë‹´ì‚¬ì…ë‹ˆë‹¤. 
ëŒ€í•™ìƒì´ ì›” 50ë§Œì› ìš©ëˆìœ¼ë¡œ ì–´ë–»ê²Œ 100ë§Œì›ì„ ëª¨ì„ ìˆ˜ ìˆì„ì§€ ê°„ë‹¨í•œ ì¡°ì–¸ì„ 3ê°€ì§€ë§Œ í•œêµ­ì–´ë¡œ ë‹µë³€í•´ì£¼ì„¸ìš”.

ë‹µë³€ í˜•ì‹:
- í•µì‹¬ ë‹µë³€
- êµ¬ì²´ì  ì¡°ì–¸ (3ê°œ)
- ì£¼ì˜ì‚¬í•­
- ë‹¤ìŒ ë‹¨ê³„`;

                const result = await callGeminiAPI(prompt);
                
                showResult('financialTestResult', 
                    `âœ… ê¸ˆìœµ ìƒë‹´ í…ŒìŠ¤íŠ¸ ì„±ê³µ!\n\nì§ˆë¬¸: ëŒ€í•™ìƒ ì ˆì•½ ë°©ë²•\n\në‹µë³€:\n${result}`, 
                    'success'
                );
            } catch (error) {
                showResult('financialTestResult', 
                    `âŒ ê¸ˆìœµ ìƒë‹´ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨:\n\nì˜¤ë¥˜: ${error.message}`, 
                    'error'
                );
            }
        }

        // ì˜ˆì‚° ë¶„ì„ í…ŒìŠ¤íŠ¸
        async function testBudgetAnalysis() {
            showLoading('budgetTestResult');
            
            try {
                const prompt = `ì›” ì†Œë“ 100ë§Œì›ì„ ê¸°ì¤€ìœ¼ë¡œ ì˜ˆì‚° ë¶„ì„ ë° ì¡°ì–¸ì„ ì œê³µí•´ì£¼ì„¸ìš”.

í˜„ì¬ ì§€ì¶œ í˜„í™©:
- ì‹ë¹„: 30ë§Œì›
- êµí†µë¹„: 10ë§Œì›
- í†µì‹ ë¹„: 5ë§Œì›
- ê¸°íƒ€: 15ë§Œì›

ëª©í‘œ: 6ê°œì›” ë‚´ 200ë§Œì› ëª¨ìœ¼ê¸°

ë‹¤ìŒ ì‚¬í•­ì„ ë¶„ì„í•´ì£¼ì„¸ìš”:
1. ì§€ì¶œ íŒ¨í„´ ë¶„ì„
2. ì ˆì•½ ê¸°íšŒ
3. ëª©í‘œ ë‹¬ì„±ì„ ìœ„í•œ ì˜ˆì‚° ê³„íš
4. êµ¬ì²´ì ì¸ ì ˆì•½ ë°©ë²•
5. ë‹¤ìŒ ë‹¬ ì˜ˆì‚° ì œì•ˆ`;

                const result = await callGeminiAPI(prompt);
                
                showResult('budgetTestResult', 
                    `âœ… ì˜ˆì‚° ë¶„ì„ í…ŒìŠ¤íŠ¸ ì„±ê³µ!\n\në¶„ì„ ìš”ì²­: ì›” 100ë§Œì› ì˜ˆì‚° ë¶„ì„\n\në¶„ì„ ê²°ê³¼:\n${result}`, 
                    'success'
                );
            } catch (error) {
                showResult('budgetTestResult', 
                    `âŒ ì˜ˆì‚° ë¶„ì„ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨:\n\nì˜¤ë¥˜: ${error.message}`, 
                    'error'
                );
            }
        }

        // íˆ¬ì ìƒë‹´ í…ŒìŠ¤íŠ¸
        async function testInvestmentAdvice() {
            showLoading('investmentTestResult');
            
            try {
                const prompt = `íˆ¬ì ìƒë‹´ì„ ë°›ê³  ì‹¶ìŠµë‹ˆë‹¤:

íˆ¬ì ê¸ˆì•¡: 100ë§Œì›
íˆ¬ì ê¸°ê°„: 1ë…„
ìœ„í—˜ ì„±í–¥: ë³´ìˆ˜ì 
íˆ¬ì ëª©í‘œ: ì•ˆì „í•œ ìì‚° ì¦ì‹

ë‹¤ìŒ ì‚¬í•­ì„ ê³ ë ¤í•˜ì—¬ íˆ¬ì ì¡°ì–¸ì„ ì œê³µí•´ì£¼ì„¸ìš”:
1. ì í•©í•œ íˆ¬ì ìƒí’ˆ ì¶”ì²œ
2. ìì‚° ë°°ë¶„ ì „ëµ
3. ìœ„í—˜ ê´€ë¦¬ ë°©ë²•
4. ì •ê¸°ì ì¸ í¬íŠ¸í´ë¦¬ì˜¤ ì ê²€ ë°©ë²•
5. í•œêµ­ íˆ¬ì í™˜ê²½ì—ì„œì˜ ì£¼ì˜ì‚¬í•­`;

                const result = await callGeminiAPI(prompt);
                
                showResult('investmentTestResult', 
                    `âœ… íˆ¬ì ìƒë‹´ í…ŒìŠ¤íŠ¸ ì„±ê³µ!\n\nìƒë‹´ ìš”ì²­: 100ë§Œì› ë³´ìˆ˜ì  íˆ¬ì\n\nìƒë‹´ ê²°ê³¼:\n${result}`, 
                    'success'
                );
            } catch (error) {
                showResult('investmentTestResult', 
                    `âŒ íˆ¬ì ìƒë‹´ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨:\n\nì˜¤ë¥˜: ${error.message}`, 
                    'error'
                );
            }
        }

        // ì „ì²´ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
        async function runAllTests() {
            showLoading('allTestsResult');
            
            const results = [];
            const tests = [
                { name: 'ê¸°ë³¸ ì—°ê²°', func: testBasicConnection },
                { name: 'ê¸ˆìœµ ìƒë‹´', func: testFinancialAdvice },
                { name: 'ì˜ˆì‚° ë¶„ì„', func: testBudgetAnalysis },
                { name: 'íˆ¬ì ìƒë‹´', func: testInvestmentAdvice }
            ];
            
            for (const test of tests) {
                try {
                    results.push(`âœ… ${test.name}: ì„±ê³µ`);
                } catch (error) {
                    results.push(`âŒ ${test.name}: ì‹¤íŒ¨ - ${error.message}`);
                }
                
                // API í˜¸ì¶œ ê°„ê²© ì¡°ì ˆ
                await new Promise(resolve => setTimeout(resolve, 1000));
            }
            
            showResult('allTestsResult', 
                `ğŸš€ ì „ì²´ í…ŒìŠ¤íŠ¸ ì™„ë£Œ!\n\n${results.join('\n')}`, 
                'success'
            );
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ API í‚¤ ê²€ì¦
        window.onload = function() {
            validateAPIKey();
        };
    </script>
</body>
</html>
